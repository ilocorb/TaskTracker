{% extends 'base.html' %}

{% block content %}

<!-- Dashboard Section -->
<section id="dashboard-section">
    <!-- Header -->
    <header class="glass-header">
        <div class="header-top">
            <div class="user-welcome">
                <span>Hello,</span>
                <strong id="user-display-name">Loading...</strong>
            </div>
            <div style="display: flex; gap: 10px;">
                <button id="admin-btn" class="icon-btn" title="Admin Panel" style="display: none;">
                    <i class="fas fa-user-shield"></i>
                </button>
                <button id="logout-btn" class="icon-btn" title="Logout">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-labels">
                <span>Daily Progress</span>
                <span id="progress-text">0%</span>
            </div>
            <div class="progress-bar-bg">
                <div class="progress-bar-fill" id="progress-fill" style="width: 0%;"></div>
            </div>
        </div>
    </header>

    <!-- Controls (Search & Filter) -->
    <div class="controls-area">
        <div class="search-bar">
            <i class="fas fa-search"></i>
            <input type="text" id="search-input" placeholder="Search tasks...">
        </div>

        <div class="filter-sort-row">
            <select id="filter-select" class="glass-select">
                <option value="all">All Tasks</option>
                <option value="open">Open</option>
                <option value="done">Completed</option>
                <option value="high_priority">High Priority</option>
                <option value="overdue">Overdue</option>
            </select>
            <select id="sort-select" class="glass-select">
                <option value="created_at">Newest</option>
                <option value="due_date">Due Date</option>
                <option value="priority">Priority</option>
            </select>
        </div>
    </div>

    <!-- Task List - 3 Column Grid for Desktop, Single List for Mobile -->
    <div id="tasks-container" class="tasks-container">
        <!-- Desktop: 3-column grid -->
        <div class="tasks-grid">
            <!-- TO-DO Column -->
            <div class="task-column">
                <div class="column-header">
                    <i class="fas fa-circle"></i>
                    <h3>TO-DO</h3>
                    <span class="task-count" id="todo-count">0</span>
                </div>
                <div id="todo-tasks" class="tasks-list">
                    <!-- TO-DO tasks injected here -->
                </div>
            </div>

            <!-- In Progress Column -->
            <div class="task-column">
                <div class="column-header in-progress">
                    <i class="fas fa-spinner"></i>
                    <h3>In Progress</h3>
                    <span class="task-count" id="in-progress-count">0</span>
                </div>
                <div id="in-progress-tasks" class="tasks-list">
                    <!-- In Progress tasks injected here -->
                </div>
            </div>

            <!-- Done Column -->
            <div class="task-column">
                <div class="column-header done">
                    <i class="fas fa-check-circle"></i>
                    <h3>Done</h3>
                    <span class="task-count" id="done-count">0</span>
                </div>
                <div id="done-tasks" class="tasks-list">
                    <!-- Done tasks injected here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Action Button -->
    <button id="add-task-btn" class="fab" title="Add Task">
        <i class="fas fa-plus"></i>
    </button>
</section>


<!-- Add/Edit Task Modal -->
<div id="task-modal" class="modal hidden">
    <div class="modal-content glass-panel">
        <div class="modal-header">
            <h2 id="modal-title">Add New Task</h2>
            <button id="close-modal" class="icon-btn"><i class="fas fa-times"></i></button>
        </div>
        <form id="task-form">
            <input type="hidden" id="task-id">
            <div class="form-group">
                <label>Title</label>
                <input type="text" id="task-title" class="glass-input"
                    placeholder="Conquer the world, one task at a time!" required>
            </div>
            <div class="form-group">
                <label>Description</label>
                <textarea id="task-desc" class="glass-input" rows="3"></textarea>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label>Priority</label>
                    <select id="task-priority" class="glass-select">
                        <option value="low">Low</option>
                        <option value="medium" selected>Medium</option>
                        <option value="high">High</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Due Date</label>
                    <input type="date" id="task-due" class="glass-input">
                </div>
            </div>
            <div class="form-group">
                <label>Tags (comma separated)</label>
                <input type="text" id="task-tags" class="glass-input" placeholder="e.g. work, school">
            </div>
            <div class="modal-actions">
                <button id="delete-task-btn" type="button" class="btn-delete-modal hidden">
                    <i class="fas fa-trash"></i>
                </button>
                <button id="submit-btn" type="submit" class="btn-primary">Add Task</button>
            </div>
        </form>
    </div>
</div>

{% endblock %}